CREATE OR REPLACE FUNCTION issue_book(
	reader_id INTEGER,
	book_inv_number INTEGER,
	return_date DATE
)
RETURN VOID AS $$
BEGIN
	INSERT_INTO public.issuance(
		reader_card_number,
		inventory_number,
		issue_datetime,
		expexted_return_data
	)
	VALUES(
		reader_id,
		book_inv_number,
		NOW(),
		return_date
	);

	UPDATE public.book_instance
	SET status = 'issued'
	WHERE inventory_number = book_inv_number;
END;
$$ LANGUAGE plpgsql;